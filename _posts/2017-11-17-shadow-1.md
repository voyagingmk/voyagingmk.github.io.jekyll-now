---
layout: post_latex
title: 方差阴影贴图与切比雪夫不等式
tags: ['computer graphics']
published: true
---

要理解方差阴影贴图的来龙去脉，必须先深刻理解概率论中的几个概念：

- 矩(Moment)
- 数学期望(Mean)
- 方差(Variance)
- 马可夫不等式 (Markov's Inequality)
- 切比雪夫不等式 (Chebyshev's inequality)

<!--more-->

## 矩(Moment)

https://en.wikipedia.org/wiki/Moment_(mathematics)

给定关于实变量x、常数c的实值连续函数f(x)，它的n阶矩（n-th moment)的公式是：

\\[ \\mu \^\{n\} = \\int \_\{-\\infty \}\^\{ +\\infty  \} (x - c)\^\{n\} f(x) dx \\] 

## 数学期望(Mean)

当c = 0，n = 1时，上述公式变成：

\\[ \\mu = \\int \_\{-\\infty \}\^\{ +\\infty  \} x f(x) dx \\] 

这也就是数学期望(Mean)的积分公式。


## 方差(Variance)

当\\(c = \\mu\\)时，n阶矩可称为**n阶中心矩**；当\\(c = \\mu，n = 2\\)时，2阶中心矩的公式为：

\\[ \\mu \^\{2\} =  \\int \_\{-\\infty \}\^\{ +\\infty  \} (x - \\mu )\^\{ 2 \} f(x) dx \\] 

这其实就是方差(Variance)的积分公式。下面作简单推导。

方差的定义式为：

\\[ Var(X) = E[(X - \\mu)\^\{2\}] =  E[(X - E[X])\^\{2\}] \\]

可以推出：

\\[ Var(X) = E[X\^\{2\} - 2 X E[X] + E[X]\^\{2\} ] \\]

\\[ = E[X\^\{2\}] - 2 E[X] E[X] + E[X]\^\{2\} \\]

\\[ = E[X\^\{2\}] -  E[X]\^\{2\} \\]

而2阶中心矩公式可以推出：

\\[ \\int (x - \\mu )\^\{ 2 \} f(x) dx \\] 

\\[ = \\int x\^\{ 2 \} f(x) dx - 2\\mu \\int x f(x) dx + \\int \\mu \^\{ 2 \} f(x) dx \\] 

\\[ = \\int x\^\{ 2 \} f(x) dx - 2\\mu \\cdot \\mu + \\mu \^\{ 2 \} \\] 

\\[ = \\int x\^\{ 2 \} f(x) dx - \\mu \^\{ 2 \} \\] 

\\[ =E[X\^\{ 2 \}] - E[X] \^\{ 2 \} \\] 

## 马可夫不等式 (Markov's Inequality)

设X是非负的随机变量，且有a > 0，那么X大于等于a的概率不超过X的数学期望除以a：

\\[ P \_\{ X \\geq a \} \\leq \frac \{ E[X] \}\{ a \} \\]

证明：

证明前需要先理解一个概念：示性函数（Indicator）。对于任意事件e，当e发生时，\\( I \_\{e\}  = 1\\)， 当E没发生时，\\( I \_\{e\} = 0\\)。

那么把\\( X \\geq a \\)当作一个事件e，当e发生时，有：

\\[  I \_\{ X \\geq a \}  = 1  \\]

\\[   a I \_\{ X \\geq a \} \\leq X   \\]

两边同时变成数学期望，不等式依然成立：

\\[   E[a I \_\{ X \\geq a \}] \\leq E[X]   \\]

又因为数学期望的线性关系，有：

\\[  E[a I \_\{ X \\geq a \}] = a \\cdot E[I \_\{ X \\geq a \}]   \\]

又因为函数\\( I \_\{ X \\geq a \} \\)的取值只有2种，所以可直接得到：

\\[  a \\cdot E[I \_\{ X \\geq a \}] = a \\cdot ( 1\\cdot P \_\{ X \\geq a \} + 0\\cdot P \_\{ X \\lt a \}   ) \\]

\\[  = a \\cdot P \_\{ X \\geq a \} \\]

综上，就得到了：

\\[   a \\cdot P \_\{ X \\geq a \} \\leq E[X]   \\]

\\[ P \_\{ X \\geq a \} \\leq \frac \{ E[X] \}\{ a \} \\]

## 切比雪夫不等式 (Chebyshev's inequality)
