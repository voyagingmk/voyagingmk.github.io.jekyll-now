---
layout: post_latex
title: 曲线数学之贝塞尔曲线Bézier Curves
tags: ['curve']
published: true
---

本文主要关注的是公式的推导。

在讲贝塞尔曲线之前先复习下组合数学。


<!--more-->

## 组合数学

### 排列 permutation

注意，排列的英文是permutation，这个词也就是线性代数里的“置换”。联想置换矩阵的概念，就可以近似理解“排列”的意义。


permutation的公式是：

\\[ P(n,k) = P\_\{n\}\^\{k\} = \\frac \{n!\}\{(n-k)!\} \\]

含义：从n个数取出某k个数总共有多少种排列。

所以，排列是**有顺序**的。

### 组合 combination

组合这个东西可以用“排列”来理解，比如对于某3个不同的数a、b、c，有\\[ P\_\{3\}\^\{3\} = \\frac \{3!\}\{(3-3)!\} = 6 \\]种排列: abc、acb、bac、bca、cab、cba，然而，组合数只有一个，也就是[a、b、c]。

所以，组合是**没有顺序**的。

combination的公式是：

\\[ C(n,k)  = C\_\{n\}\^\{k\} = \\frac \{ P\_\{n\}\^\{k\} \} \{ P\_\{k\}\^\{k\} \} = \\frac \{n!\}\{k!(n-k)!\} , 0 < k <= n\\]


性质1：

\\(  C\_\{n\}\^\{k\} = \\frac \{n!\}\{k!(n-k)!\} \\)

\\( = \\frac \{n!\}\{(n-(n-k))!(n-k)!\} \\)

\\( = \\frac \{n!\}\{(n-k)!(n-(n-k))!\} \\)

\\( = C\_\{n\}\^\{n-k\} \\)

性质2：

\\[  C\_\{n\}\^\{k\} = \\frac \{n!\}\{k!(n-k)!\} = 0 【 k < 0 ， k > n】 \\] 

(当k<0或k>n时，右边的式子会出现负数的阶乘。负数阶乘在组合数公式的计算中，可以认为等于0)


combination很重要，比如说二项式定理里的展开式就用到了它：

\\[ (a+b)\^\{n\} = \\sum\_\{r=0\}\^\{n\}C\_\{n\}\^\{r\}a\^\{n-r\}b\^\{r\} \\]



combination还有一条公式要注意下：

\\[ C\_\{n\}\^\{k\} = C\_\{n-1\}\^\{k-1\} + C\_\{n-1\}\^\{k\} , 0 < k < n \\]

顺便给个简单证明：

\\( C\_\{n-1\}\^\{k-1\} + C\_\{n-1\}\^\{k\} = \\)

\\( \\frac \{(n-1)!\}\{(n-1-(k-1))!(k-1)!\} + \\frac \{(n-1)!\}\{(n-1-k)!k!\}  = \\)

\\( \\frac \{(n-1)!\}\{(n-k)!(k-1)!\} + \\frac \{(n-1)!\}\{(n-1-k)!k!\}  = \\)

\\( \\frac \{k(n-1)!\}\{k(n-k)!(k-1)!\} + \\frac \{(n-k)(n-1)!\}\{(n-k)(n-1-k)!k!\}  = \\)

\\( \\frac \{k(n-1)!\}\{(n-k)!k!\} + \\frac \{(n-k)(n-1)!\}\{(n-k)!k!\}  = \\)

\\( \\frac \{k(n-1)!+(n-k)(n-1)!\}\{(n-k)!k!\}  = \\)

\\( \\frac \{n(n-1)!\}\{(n-k)!k!\}  =  \\frac \{n!\}\{(n-k)!k!\}  =   C\_\{n\}\^\{k\} \\)

## 贝塞尔曲线

### 定义

给定n个控制点\\(P\_\{0\},P\_\{1\},\\cdots ,P\_\{n\}\\)，贝塞尔曲线的公式如下：

\\[ P(t) = \\sum\_\{i=0\}\^\{n\}P\_\{i\}B\_\{i,n\}(t) , t\\in [0,1] \\]

其中的\\( B\_\{i,n\}(t) \\)叫Bernstein polynomial，定义如下：

\\[ B\_\{i,n\}(t) = C\_\{n\}\^\{i\}t\^\{i\}(1-t)\^\{n-i\} = \\frac \{n!\}\{i!(n-i)!\}t\^\{i\}(1-t)\^\{n-i\} 【i=0,1,\\cdots ,n】 \\]

### \\( B\_\{i,n\}(t) \\)的特性


#### 递归性

\\[ B\_\{i,n\}(t) = (1-t)B\_\{i,n-1\}(t) + tB\_\{i-1,n-1\}(t)   【i=0,1,\\cdots ,n】 \\]

证明：

\\( B\_\{i,n\}(t) \\)

\\( = C\_\{n\}\^\{i\}t\^\{i\}(1-t)\^\{n-i\} \\)

\\( = C\_\{n-1\}\^\{i-1\} + C\_\{n-1\}\^\{i\})t\^\{i\}(1-t)\^\{n-i\} \\)

\\( = C\_\{n-1\}\^\{i-1\}t\^\{i\}(1-t)\^\{n-i\} + C\_\{n-1\}\^\{i\}t\^\{i\}(1-t)\^\{n-i\} \\)

\\( = (1-t)C\_\{n-1\}\^\{i\}t\^\{i\}(1-t)\^\{(n-1)-i\} + tC\_\{n-1\}\^\{i-1\}t\^\{i-1\}(1-t)\^\{(n-1)-(i-1)\} \\)

\\( = (1-t)B\_\{i,n-1\}(t) + tB\_\{i-1,n-1\}(t) \\)



#### 归一性

\\[ \\sum\_\{i=0\}\^\{n\}B\_\{i,n\}(t) \\equiv 1   【t\\in (0,1)】 \\]


证明：

根据二项式定理有：

\\[ \\sum\_\{i=0\}\^\{n\}B\_\{i,n\}(t) \\]
\\[ = \\sum\_\{i=0\}\^\{n\}C\_\{n\}\^\{i\}t\^\{i\}(1-t)\^\{n-i\} \\]
\\[ [(1-t)+t]\^\{n\} \\equiv 1  \\]


#### Partition of Unity

\\[ \\sum\_\{i=0\}\^\{n\}B\_\{i,n\}(t) = \\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t) = 1 \\]

证明:

利用递归公式，有：

\\( \\sum\_\{i=0\}\^\{n\}B\_\{i,n\}(t) \\)

\\( = \\sum\_\{i=0\}\^\{n\}[(1-t)B\_\{i,n-1\}(t) + tB\_\{i-1,n-1\}(t)] \\)

\\( = \\sum\_\{i=0\}\^\{n\}[(1-t)B\_\{i,n-1\}(t)] + \\sum\_\{i=0\}\^\{n\}[tB\_\{i-1,n-1\}(t)] \\)

\\( = (1-t)\\sum\_\{i=0\}\^\{n\}[B\_\{i,n-1\}(t)] + t\\sum\_\{i=0\}\^\{n\}[B\_\{i-1,n-1\}(t)] \\)

\\( = (1-t)[\\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t) + B\_\{n,n-1\}(t) ] + t[\\sum\_\{i=1\}\^\{n\}B\_\{i-1,n-1\}(t) + B\_\{-1,n-1\}(t) ] \\)

因为:

\\[ B\_\{n,n-1\}(t) = C\_\{n-1\}\^\{n\}t\^\{n\}(1-t)\^\{n-1-n\} = 0 \\]

\\[ B\_\{-1,n-1\}(t) = C\_\{n-1\}\^\{-1\}t\^\{-1\}(1-t)\^\{(n-1)-(-1)\} = 0 \\]

(这里利用了上文提到的组合数公式性质2)

所以可简化为：

\\( \\sum\_\{i=0\}\^\{n\}B\_\{i,n\}(t) \\)

\\( = (1-t)[\\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t)] + t[\\sum\_\{i=1\}\^\{n\}B\_\{i-1,n-1\}(t)] \\)

\\( = (1-t)[\\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t)] + t[\\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t)] \\)

\\( = (1-t+t)[\\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t)] \\)

\\( = \\sum\_\{i=0\}\^\{n-1\}B\_\{i,n-1\}(t) \\)


#### 对称性

\\[ B\_\{i,n\}(1 - t) = B\_\{n-i,n\}(t) \\]


证明：

由定义：

\\[ B\_\{i,n\}(t) = C\_\{n\}\^\{i\}t\^\{i\}(1-t)\^\{n-i\} \\]

有：

\\( B\_\{n-i,n\}(t) = C\_\{n\}\^\{n-i\}t\^\{n-i\}(1-t)\^\{n-(n-i)\}  \\)

\\( = C\_\{n\}\^\{n-i\}t\^\{n-i\}(1-t)\^\{i\}  \\)

\\( = C\_\{n\}\^\{i\}t\^\{n-i\}(1-t)\^\{i\} \\)


\\( B\_\{i,n\}(1 - t) =  C\_\{n\}\^\{i\}(1 - t)\^\{i\}(1-(1 - t))\^\{n-i\} \\)

\\( = C\_\{n\}\^\{i\}(1 - t)\^\{i\}t\^\{n-i\} \\)

\\( = C\_\{n\}\^\{i\}t\^\{n-i\}(1-t)\^\{i\} \\)

得证。
