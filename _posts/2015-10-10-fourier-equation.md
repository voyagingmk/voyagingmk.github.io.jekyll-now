---
layout: post_latex
title: 学习傅里叶变换
published: true
tags: ['fourier','math']
---

本文主要写的是公式层面的推导，关于傅里叶变换的应用，请到知乎搜索'傅里叶'，能找到很多不错的文章。

本文主要参考了斯坦福大学Brad Osgood的公开课:

[http://open.163.com/special/opencourse/fouriertransforms.html](http://open.163.com/special/opencourse/fouriertransforms.html)

youtube的比较高清:

[https://www.youtube.com/watch?v=gZNm7L96pfY](https://www.youtube.com/watch?v=gZNm7L96pfY)

<!--more-->

## 傅里叶级数

翻译一下wiki的fourier series：

> 在数学中，傅里叶级数是一个**可以把(有波形的)函数表示成多个简单的sin函数的叠加**的方法。更形式地说，傅里叶级数能够把任意周期函数(信号)分解成**有限(或无限)个简单的震荡函数的叠加**，这些震荡函数可以是正弦函数、余弦函数或复指数。

傅里叶级数的公式定义（不要问为什么长这样，这只是一个定义，不是推出来的公式)：

\\[ S = \\sum\_\{k=1\}\^\{n\}A\_\{k\}\\sin (2\\pi kt+\\phi \_\{k\}) \\]

(如果不清楚什么是级数，请戳 [https://en.wikipedia.org/wiki/Series_(mathematics)](https://en.wikipedia.org/wiki/Series_(mathematics) )

使用三角函数的一道公式:

\\[ \\sin (\\alpha + \\beta ) = \\sin \\alpha \\cos \\beta + \\cos \\alpha \\sin \\beta \\]

代入到傅里叶级数，得：

\\[ \\sin (2\\pi kt + \\phi \_\{k\}) =\\sin 2\\pi kt \\cos \\phi \_\{k\} + \\cos 2\\pi kt \\sin \\phi \_\{k\} \\]

\\[ S = \\sum\_\{k=1\}\^\{n\}A\_\{k\}\\sin 2\\pi kt \\cos \\phi \_\{k\} + \\sum\_\{k=1\}\^\{n\}A\_\{k\}\\cos 2\\pi kt \\sin \\phi \_\{k\} \\]


再设:

\\[ a\_\{k\} = A\_\{k\}\\cos \\phi \_\{k\} \\]

\\[ b\_\{k\} = A\_\{k\}\\sin \\phi \_\{k\} \\]

则上面的傅里叶级数被简化成:

\\[ S = \\sum\_\{k=1\}\^\{n\}a\_\{k\}\\sin 2\\pi kt + \\sum\_\{k=1\}\^\{n\}b\_\{k\}\\cos 2\\pi kt \\]
\\[  S(x) = \\sum\_\{k=1\}\^\{n\}(a\_\{k\}\\sin 2\\pi kt + b\_\{k\}\\cos 2\\pi kt) \\]

这是傅里叶级数的常用形式1。

常用形式2是这样的：

\\[  S = \\frac \{A\_\{0\}\}\{2\} + \\sum\_\{k=1\}\^\{n\}(a\_\{k\}\\sin 2\\pi kt + b\_\{k\}\\cos 2\\pi kt) \\]

前面多出来的那个东西，不复杂，先不管它。

常用形式3，是最重要的：用复指数来表示傅里叶级数。怎么实现？其实就是用了**欧拉公式**：

\\[ e\^\{ix\} = \\cos x + i\\sin x\\]

（关于欧拉公式的推导，可以看我的另一篇文章:[复数和三角函数](http://www.qiujiawei.com/complex-1) )

把 \\( x = 2\\pi kt \\)代入到欧拉公式，得到:

\\[   e\^\{i2\\pi kt\} = \\cos 2\\pi kt + i\\sin 2\\pi kt\\]

再搬出另外两条欧拉公式的推论:

\\[ \\cos x = \\frac \{e\^\{ix\} + e\^\{-ix\}\}\{2\} \\]

\\[ \\sin x = \\frac \{e\^\{ix\} - e\^\{-ix\}\}\{2i\} \\]

也把 \\( x = 2\\pi kt \\)代入，得到:


\\[ \\cos 2\\pi kt = \\frac \{e\^\{i2\\pi kt\} + e\^\{-i2\\pi kt\}\}\{2\} \\]

\\[ \\sin 2\\pi kt = \\frac \{e\^\{i2\\pi kt\} - e\^\{-i2\\pi kt\}\}\{2i\} \\]

这时候，教授突然说，傅里叶级数可以写成:

\\[ f(t) = \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]

这个式子确实是常用形式3——复指数表示的傅里叶级数。
但是，这究竟是怎么得到的呢。

请耐心看下文。

### 复指数形式的傅里叶级数的\\(c\_\{k\}\\)的性质

对于傅里叶级数f(t)，假设它是一个"实信号(real signal)"（一般来说，傅里叶变换处理的目标都是实信号)，
那么就有等式:

\\[ f(t) = \\overline \{f(t)\} \\]

即是说，f(t)没有虚部。而又因为：

\\[ f(t) = \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]

\\[ \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} = \\overline \{\\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\}\} = \\sum\_\{k=-n\}\^\{n\}\\overline \{c\_\{k\}\}\\overline \{e\^\{2\\pi ikt\}\} = \\sum\_\{k=-n\}\^\{n\}\\overline \{c\_\{k\}\}e\^\{-2\\pi ikt\} \\]

然后，要注意一个事实是：这个级数是从-n到n的累加，根据加法交换律，这个级数也可以变成从n到-n的累加，也即:

\\[ \\sum\_\{k=-n\}\^\{n\} = \\sum\_\{k=n\}\^\{-n\}  \\]

于是，把傅里叶级数的k变成-k，就有:

\\[ \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} = \\sum\_\{-k=-n\}\^\{n\}c\_\{-k\}e\^\{-2\\pi ikt\} = \\sum\_\{k=n\}\^\{-n\}c\_\{-k\}e\^\{-2\\pi ikt\} = \\sum\_\{k=-n\}\^\{n\}c\_\{-k\}e\^\{-2\\pi ikt\} \\]

再对比上面的推导，就会发现：

\\[ c\_\{-k\} = \\overline \{c\_\{k\}\} \\]

先记住这个性质，然后继续往下看。

设有复数z，它必然会满足一个性质：

\\[ z + \\overline \{z\} = 2Re\\{ z \\} \\]

Re{···}代表取出花括号的复数表达式的实部。

对于傅里叶级数，也可以把它当成一个复数，再利用刚刚推导出来的\\(c\_\{-k\} = \\overline \{c\_\{k\}\} \\)，就有：


\\[ c\_\{k\}e\^\{2\\pi ikt\} + c\_\{-k\}e\^\{2\\pi i(-k)t\} = c\_\{k\}e\^\{2\\pi ikt\} + c\_\{-k\}e\^\{-2\\pi ikt\}\\]
\\[ = c\_\{k\}e\^\{2\\pi ikt\} + \\overline \{c\_\{k\}\}e\^\{\\overline \{2\\pi ikt\}\} \\]
\\[ = c\_\{k\}e\^\{2\\pi ikt\} + \\overline \{c\_\{k\}e\^\{2\\pi ikt\}\} \\]
\\[ = 2Re\\{ c\_\{k\}e\^\{2\\pi ikt\} \\} \\]

这个结果表明，\\(c\_\{k\}e\^\{2\\pi ikt\} + c\_\{-k\}e\^\{2\\pi i(-k)t\} \\)是一个实数。把这个结论代入到傅里叶级数，就可以得到：

\\[ f(t) = \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]
\\[ = \\sum\_\{k=0\}\^\{n\}2Re\\{ c\_\{k\}e\^\{2\\pi ikt\} \\} \\]
\\[ = 2Re\\{ \\sum\_\{k=0\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\} \\]

注意，这个式子是把0和-0都算进去的。如果不允许signed zero，就要对k=0的情况特殊处理。


### 求解\\(c\_\{k\}\\)的积分形式

回到前面的那个傅里叶级数f(t)：

\\[ f(t) = \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]

其实是这样子搞出来的：
先假设傅里叶的**常用形式2**可以变换成这个等式，然后求\\(c\_\{k\}\\)，求得出来的话，式子不就成立了嘛。

为了搞定这个事情，要使用新的招数：积分。

( 在教授的notes([https://see.stanford.edu/materials/lsoftaee261/book-fall-07.pdf](https://see.stanford.edu/materials/lsoftaee261/book-fall-07.pdf)]的第10-12页第1.5小节Lost at c，清楚地推导了一遍\\(c\_\{k\}\\)。 )

这里我按自己对原文的理解，翻译下。


我们先随便取了一个k(k在-n到n之间)，然后，对上面的傅里叶级数等式两边同时乘以\\( e\^\{-2\\pi ikt \} \\)：

\\[ e\^\{-2\\pi ikt \}f(t) = e\^\{-2\\pi ikt \}\\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]

把右边的式子展开，得到:

\\[ e\^\{-2\\pi ikt \}f(t) = \\cdots + e\^\{-2\\pi ikt \}c\_\{k\}e\^\{2\\pi ikt\} + \\cdots \\]
\\[ = \\cdots + c\_\{k\}e\^\{-2\\pi ikt\}e\^\{2\\pi ikt \} + \\cdots \\]
\\[ = \\cdots + c\_\{k\}e\^\{-2\\pi ikt + 2\\pi ikt \} + \\cdots \\]
\\[ = \\cdots + c\_\{k\} + \\cdots \\]


这时候，可以把\\(c\_\{k\}\\)移到等式左边，左边的那个东东移到右边，就得到了一个\\(c\_\{k\}\\)的表达式:

\\[ c\_\{k\}  = e\^\{-2\\pi ikt \}f(t) - \\sum\_\{k'=-n\,k'\\neq k}\^\{n\}c\_\{k'\}e\^\{2\\pi ik't\}e\^\{-2\\pi ikt \} \\]
\\[ e\^\{-2\\pi ikt \}f(t) - \\sum\_\{k'=-n\\,k'\\neq k}\^\{n\}c\_\{k'\}e\^\{2\\pi i(k'-k)t\} \\]


然后再放大招：对等式两边同时积分，范围是0到1（f(t)的t的周期为1）。

积分的时候，会发现有这么个神奇的等式:

\\[ \\int \_\{0\}\^\{1\}e\^\{2\\pi i(k'-k)t\}dt = \\left  \[ \\frac \{2\\pi i(k'-k)\}\{1\}e\^\{2\\pi i(k'-k)t\}\\right \]\_\{0\}\^\{1\} \\]
\\[ = \\frac \{2\\pi i(k'-k)\}\{1\}(e\^\{2\\pi i(k'-k)\} - e\^\{0\})\\]
\\[ = \\frac \{2\\pi i(k'-k)\}\{1\}(1-1) = 0\\]

最后那个1-1=0的前面那个1，其实用上欧拉公式就懂了，**\\( 2\\pi i(k'-k) \\)**，代表\\(\\phi =2\\pi (k'-k)\\) ,又因为k'-k必然是整数，所以\\(\\phi \\)代表了复数平面的坐标(1,0)，所以整个式子就等于1。

于是，积分等式就只剩下：

\\[ \\int \_\{0\}^\{1\}c\_\{k\}dt = \\int \_\{0\}^\{1\}e\^\{-2\\pi ikt \}f(t)dt \\]

\\[ (1-0)c\_\{k\} = c\_\{k\} = \\int \_\{0\}^\{1\}e\^\{-2\\pi ikt \}f(t)dt \\]

这就是\\(c\_\{k\}\\)的积分形式。

做一个小结：

如果对于一个已知的周期为1的周期函数f(t)，它可以写成这样的形式：

\\[ f(t) = \\sum\_\{k=-n\}\^\{n\}c\_\{k\}e\^\{2\\pi ikt\} \\]

那么其中的\\(c\_\{k\}\\)必然满足：

\\[ c\_\{k\} = \\int \_\{0\}^\{1\}e\^\{-2\\pi ikt \}f(t)dt \\]


### 求解\\(c\_\{k\}\\)的非积分形式

回到傅里叶级数的常用形式2:

\\[  f(t) = \\frac \{A\_\{0\}\}\{2\} + \\sum\_\{k=1\}\^\{n\}(a\_\{k\}\\sin 2\\pi kt + b\_\{k\}\\cos 2\\pi kt) \\]

代入下面这2个式子:

\\[ \\cos 2\\pi kt = \\frac \{e\^\{i2\\pi kt\} + e\^\{-i2\\pi kt\}\}\{2\} \\]

\\[ \\sin 2\\pi kt = \\frac \{e\^\{i2\\pi kt\} - e\^\{-i2\\pi kt\}\}\{2i\} \\]

得:

\\[ f(t) = \\frac \{A\_\{0\}\}\{2\} + \\sum\_\{k=1\}\^\{n\}(a\_\{k\}\\frac \{e\^\{i2\\pi kt\} - e\^\{-i2\\pi kt\}\}\{2i\} + b\_\{k\}\\frac \{e\^\{i2\\pi kt\} + e\^\{-i2\\pi kt\}\}\{2\}) \\]
\\[  = \\frac \{A\_\{0\}\}\{2\} + \\sum\_\{k=1\}\^\{n\}(\\frac \{b\_\{k\} - ia\_\{k\}\}\{2\}e\^\{i2\\pi kt\} + \\frac \{b\_\{k\} + ia\_\{k\}\}\{2\}e\^\{-i2\\pi  kt\})  \\]

设:

\\[ c\_\{0\} = \\frac \{1\}\{2\}A\_\{0\} \\]
\\[ c\_\{k\} = \\frac \{1\}\{2\}(b\_\{k\} - ia\_\{k\}) \\]
\\[ c\_\{-k\} = \\overline \{c\_\{k\}\} = \\frac \{1\}\{2\}(b\_\{k\} + ia\_\{k\}) \\]

（注意，第三个式子是利用了前面的结论 ）

则:

\\[ f(t) = c\_\{0\} + \\sum\_\{k=1\}\^\{n\}(c\_\{k\}e\^\{i2\\pi kt\} + c\_\{-k\}e\^\{-i2\\pi  kt\}) \\]
\\[ = c\_\{0\} + \\sum\_\{k=1\}\^\{n\}c\_\{k\}e\^\{i2\\pi kt\} + \\sum\_\{k=1\}\^\{n\}c\_\{-k\}e\^\{-i2\\pi  kt\} \\]
\\[ = c\_\{0\} + \\sum\_\{k=1\}\^\{n\}c\_\{k\}e\^\{i2\\pi kt\} + \\sum\_\{k=-1\}\^\{-n\}c\_\{k\}e\^\{i2\\pi  kt\} \\]
\\[ = c\_\{0\} +  \\sum\_\{k=-n,k\\neq 0\}\^\{n\}c\_\{k\}e\^\{i2\\pi kt\}   \\]

和那个常用形式3非常接近了，只需要把\\(c\_\{0\}\\)也合并到级数里即可。但，这需要有一个前提：\\( c\_\{0\} = \\frac \{1\}\{2\}A\_\{0\} \\)和k=0时的f(t)的\\( c\_\{0\} \\)相等，而这是不一定的。

傅里叶级数是很不错的东西，但是实际应用时，要考虑很多细节，不是随便用就可以的。


###大跃进，终极的傅里叶级数的复指数形式

终极的傅里叶级数的复指数形式是(fourier series exponential form)：

\\[ f(t) = c\_\{0\} + \\sum\_\{k=-\\infty \}\^\{\\infty \}c\_\{k\}e\^\{ik\\omega t\} \\]

\\[ c\_\{k\} = \\frac \{T\}\{1\}\\int \_\{-\\frac \{2\}\{T\} \}^\{\\frac \{2\}\{T\} \}f(t)e\^\{-ik\\omega t\}dt \\]








